<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>radicle</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" type="text/css" media="screen" href="css/style.css" />
  <link rel="stylesheet" type="text/css" media="screen" href="css/codemirror-repl.css" />
  <link rel="stylesheet" type="text/css" media="screen" href="css/repl-theme.css" />
  <script src="js/codemirror-repl.js"></script>
  <script src="js/rad.js"></script>
</head>

<body>
  <div class="content">
    <header>
      <h1>radicle</h1>
      <h3>A reprogammable state machine.</h3>
    </header>
    <div class="repl">
      <textarea id="repl" autofocus="true"></textarea>
    </div>
  </div>
  <footer>
    <div class="about">
      <h4>Why Radicle</h4>
      <p>
        Over the last few decades, with the emergence of open-source software, we've experienced an unprecedented acceleration in
        the development of.
      </p>
    </div>
    <div class="contact">
      <h4>Get in touch</h4>
      <p>
        If youâ€™re interested in radicle or want to contribute, you can find us here:
      </p>
      <a href="radicle@monadic.xyz">radicle@monadic.xyz</a>
      <p>#radicle on freenode</p>
    </div>
  </footer>
</body>
<script language="javascript" src="js/all.min.js"></script>

<script language="javascript">
  // Setup the repl.
  var repl = new CodeMirrorREPL("repl", {
    mode: "rad",
    theme: "base16-dark",
  });

  function sleep(ms) { return new Promise(resolve => setTimeout(resolve, ms)); }

  async function eval_fn(expr) {
    var tmp = { "arg": expr };
    try {
      eval_fn_(tmp);
      if (typeof tmp.result === "undefined") {
        console.log("sleeping in the hope this is an async call");
        await sleep(2000);
      }
      repl.print(tmp.result);
    } catch (error) {
      console.log(error);
      repl.print(error, "error");
    }
  }
  repl.eval = eval_fn;
  repl.print("Welcome to radicle!");
  repl.print("Type '(help)' for help.");
  repl.print("");
  repl.print("");

</script>

</html>
